# F12 截图工具

一个轻量级的 Windows 桌面应用程序，旨在提供快速、便捷的屏幕截图功能。通过自定义快捷键，您可以轻松截取当前鼠标所在屏幕的图像，并自动保存到按进程名称分类的文件夹中。

## ? 功能特性

- **自定义截图快捷键**: 默认 F12，可根据个人喜好在设置中修改。
- **智能截图保存**: 自动识别鼠标所在窗口的进程名称，并将截图保存到以该进程命名的文件夹中。
- **多显示器支持**: 自动检测鼠标所在的显示器并进行截图。
- **系统托盘集成**: 应用程序在后台运行，通过系统托盘图标提供快速访问和设置选项。
- **自定义保存路径**: 允许用户设置截图的保存根目录。
- **单例模式**: 确保应用程序只有一个实例在运行，避免重复启动。

## ? 使用方式

### 1. 启动应用程序

根据“启动方式”部分的说明启动应用程序。应用程序启动后，主窗口会自动隐藏，并在系统托盘区显示一个图标。

### 2. 进行截图

-   **使用快捷键**: 默认情况下，按下 `F12` 键即可截取当前鼠标所在屏幕的图像。截图会自动保存到预设或自定义的目录中。
-   **通过托盘菜单**: 右键点击系统托盘中的应用程序图标，选择“截图”选项，也可以进行截图。

### 3. 修改设置

右键点击系统托盘中的应用程序图标，选择“设置”选项，将打开设置窗口。

-   **修改截图按键**: 在设置窗口中，点击“点击设置新按键”按钮，然后按下您想要设置的新快捷键，最后点击“保存按键”。
-   **修改截图保存路径**: 在设置窗口中，点击“浏览...”按钮选择一个新的保存目录，或者点击“清除自定义路径”恢复默认保存路径，最后点击“保存路径”。

### 4. 退出应用程序

右键点击系统托盘中的应用程序图标，选择“退出”选项，即可完全关闭应用程序。

## ? 项目结构

```
F12Capture/
├── config.ini
├── gui_app.py
├── icon.png
├── launch.vbs
├── README.md
├── requirements.txt
├── start.bat
└── ScreenShots/
```

### 文件功能介绍

-   `config.ini`: 应用程序的配置文件，用于保存用户设置，如截图快捷键和自定义保存路径。
-   `gui_app.py`: 应用程序的主文件，包含所有核心逻辑，包括键盘监听、截图功能、系统托盘集成和设置界面。
-   `icon.png`: 应用程序的图标文件，显示在系统托盘和窗口中。
-   `launch.vbs`: 用于静默启动 `start.bat` 脚本的 VBScript 文件，适合普通用户直接启动，避免显示命令行窗口。
-   `README.md`: 项目说明文件，包含项目介绍、功能、启动方式、依赖、配置和文件结构等信息。
-   `requirements.txt`: 列出了项目所需的所有 Python 依赖库。
-   `start.bat`: 批处理脚本，用于检查 Python 环境、安装依赖并启动 `gui_app.py`，适合开发者调试。
-   `ScreenShots/`: 默认的截图保存目录，所有截图将按进程名称分类保存到此目录的子文件夹中。

## ? 启动方式

本工具提供三种启动方式，以适应不同用户（开发者或普通用户）的需求。

### 1. 命令行启动 (推荐开发者调试)

这种方式适合熟悉命令行的开发者，可以清晰地看到程序的输出和潜在的错误信息。

1.  **打开命令行**: 在项目根目录（`F12Capture` 文件夹）下，按住 `Shift` 键并右键点击空白处，选择“在此处打开 PowerShell 窗口”或“在此处打开命令提示符”。
2.  **安装依赖**: 如果是首次运行或依赖有更新，请运行以下命令安装所需库：
    ```bash
    pip install -r requirements.txt
    ```
3.  **启动应用**: 运行主程序：
    ```bash
    python gui_app.py
    ```

### 2. 双击 `start.bat` (推荐开发者调试)

`start.bat` 脚本会自动检查 Python 环境、安装依赖并启动应用程序。这种方式也适合开发者，因为它会显示安装和启动过程中的信息。

1.  **双击运行**: 在 `F12Capture` 文件夹中，直接双击 `start.bat` 文件。
2.  **等待**: 脚本会自动检查并安装依赖，然后启动应用程序。

### 3. 双击 `launch.vbs` (推荐普通用户直接启动)

`launch.vbs` 脚本会以静默方式启动 `start.bat`，不会显示命令行窗口，提供更简洁的用户体验。

1.  **双击运行**: 在 `F12Capture` 文件夹中，直接双击 `launch.vbs` 文件。
2.  **后台运行**: 应用程序将在后台静默启动，并在系统托盘中显示图标。

## ?? 依赖

本工具依赖以下 Python 库。它们会在您首次运行 `start.bat` 或手动执行 `pip install -r requirements.txt` 时自动安装。

-   `pynput`: 用于监听键盘和鼠标事件。
-   `screeninfo`: 用于获取显示器信息。
-   `Pillow`: 图像处理库，用于保存截图。
-   `pywin32`: 提供 Windows API 接口，用于截图和进程信息获取。
-   `psutil`: 用于获取系统进程信息。
-   `PySide6`: 用于构建图形用户界面。

## ? 配置

应用程序的配置保存在 `config.ini` 文件中。您可以通过应用程序的“设置”界面修改这些配置。

-   **截图按键**: 默认 `F12`。
-   **自定义截图目录**: 默认保存在 `ScreenShots` 文件夹中，您可以设置一个自定义的根目录。

## ? 截图保存路径

所有截图默认保存在项目根目录下的 `ScreenShots` 文件夹中。在该文件夹内，截图会根据捕获时鼠标所在窗口的进程名称自动创建子文件夹进行分类。

例如：
```
F12Capture/
├── ScreenShots/
│   ├── Chrome/
│   │   ├── 20231026_143000.png
│   │   └── 20231026_143005.png
│   ├── Code/
│   │   └── 20231026_143100.png
│   └── ...
└── ...
```

如果您在设置中配置了自定义截图目录，则所有截图将保存到您指定的目录中，并同样按照进程名称进行分类。
